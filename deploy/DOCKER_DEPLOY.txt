â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸ³ Ð”Ð•ÐŸÐ›ÐžÐ™ Ð§Ð•Ð Ð•Ð— DOCKER (Ð Ð•ÐšÐžÐœÐ•ÐÐ”Ð£Ð•Ð¢Ð¡Ð¯)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ÐŸÐ•Ð Ð’Ð«Ð™ Ð ÐÐ— (ÑÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹ Ð’Ð¡Ð Ð¸ Ð²ÑÑ‚Ð°Ð²ÑŒ Ð² Ð²ÐµÐ±-ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Timeweb):

# ÐžÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ€Ð¾Ð³Ð¾ Ð±Ð¾Ñ‚Ð°
systemctl stop smartfinances 2>/dev/null; systemctl disable smartfinances 2>/dev/null; pkill -9 -f "python.*main.py" 2>/dev/null; sleep 2

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Docker ÐµÑÐ»Ð¸ Ð½ÐµÑ‚
if ! command -v docker &> /dev/null; then
    curl -fsSL https://get.docker.com -o get-docker.sh
    sh get-docker.sh
    rm get-docker.sh
fi

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ docker-compose ÐµÑÐ»Ð¸ Ð½ÐµÑ‚
if ! command -v docker-compose &> /dev/null; then
    curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
    chmod +x /usr/local/bin/docker-compose
fi

# ÐšÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹
cd /var/www && rm -rf smartfinances && git clone https://github.com/Tue22869/Rich-Uncle-Scrooge.git smartfinances && cd smartfinances

# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ google_credentials.json
cat > google_credentials.json << 'CREDEOF'
{
  "type": "service_account",
  "project_id": "rich-uncle-scrooge",
  "private_key_id": "9a8c29733c56c9ef8eb7bc53b79459ca176c5a32",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC3PuCjiGBHIsL/\nwpUlpxEE3SlxiB1BSt+MMGTY24Sm5M2svYAPhym+8eeco3LJ79ihiZSSX5SFJEnJ\nz7/fsTAbfvusqnB6CkZRKPd8oTI8HI1xD/++6lkOTQUC5AspMwKSv7Z1dCLtJyLr\nO+O0PcIa7O+2p+yMt717LMIrKzMfNU0fqtm6sk5RJ940Z9SCqC6VvgsCB2IUCpgL\nDQ94g/R/hvN98QFA5q6ksZEw4Y2VYmlTvGVclvyxKFYah/H5VSDBX6+QZ6TE2jrz\nCXfEOErMYmZapvIRu6swpqDkoSVtbYPdiBXV0iMVzf+VB7xEBeFGPBlGV27wYzzT\niJp1cSPXAgMBAAECggEAK2p239gWc5Q9XkqUetTP9/aMdK06vTcHqxfmNOkhz0cD\nogtN9Z/hGLAI37hsIIM2sOM/c8S4lCkKYInb3JyHGOSnrXu+ZXPcwCr0JC+vDsX3\nDxQq1GmCyxwddVdhe5Pt5qYMjVyET+sHX3OTmidNv4Jms0CrD5YTC0WKBZ9ZH+ni\n4YgKbu7JSiF5j7dw3jU4I/aUvm7kRDHUW4Vx7JIDMiP6w8euWdbri6q7QiYKwpl6\n4CbuaIa7A0sMbXjkivBoJjhP9uNWL4xJOB7/OiKM4Q4AmB/GfGDVEN0EUorn/KkG\njyWXs+Z2O9/4Fotq/gyB9xhBqOHZkduPkrk/LXNoKQKBgQDdM96jOZYefZgvO9t5\n6J/u6szZpmceaORQ49sprsP6EaRyrK2T4WK8qhi74j98yRjZPaM+Mm9+oMExYQdT\nxOotL8jJ4MYBUa4bmPUCSXD/4GxhV2g8vTWFjPFuHSICIXJU/TihiNHT8xyOYVmE\nT8KYdf4YKiNG0OPLcrqBy5XGfwKBgQDUEm2BLp1InaUScPoD1kg2SKCTqSMI8vkY\nRFJ+ObrWk3SabO7yQcsYo6Hk3VBVWzmBSYQJUvk2j2JCe6vc4eS/LffWRpjGi0sK\nCS746SuIW7xasWGqvB0zYuWClUHhYZQrYuq67kGzvbt91r5w6JtKiN3qJEQCeMnh\n3QligUXmqQKBgBpUh0bUnvroJkpRDLH5L7hnuJSbyyCCidLbHIZcqDVHDlUcGtlE\nddVRRfpvVvFKmquZO6o2pLDk/7oZ+55MDTftvS/Skp8rktb0IQ3xogLDOwNnPSAl\nwY4xFbfuvdKVGp/lOG159MgO4zJLgjVOrTIqsWE8+s/+I29fK7YxfpWPAoGBAMn3\nWs5iZGwZpnGvoosw8ciw1iyKMdF+BHh16NJJjIR6HdxLzixtOEyY2b+qfa0smdFl\nABgZKzoox31lZkGP6FeiIZux1CGR2r8OC+wFs+3C39jHgaomSPD9SHJaT0mjsoa3\nR7EK4wuYsAyiDPBetjX/rsgkDZkFC87MwPlNABMxAoGBAMAOkn3BRQQY4zgeh63E\nEDu1KyvG34pfXZz7BoMqfvznhGLTAfiABkOdphSxo+D4SxmwMFe0PY9pObAJBDvC\n6I+AOPsIcC+AF+Ng0PFTapYGfnzMbpFKjYpEaZChVRUFwmZ594SbwzX0D769pkpf\nNG545PZla1c4o9GWpQRcRP65\n-----END PRIVATE KEY-----\n",
  "client_email": "rich-uncle-scrooge-bot@rich-uncle-scrooge.iam.gserviceaccount.com",
  "client_id": "106694602768827482990",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/rich-uncle-scrooge-bot%40rich-uncle-scrooge.iam.gserviceaccount.com",
  "universe_domain": "googleapis.com"
}
CREDEOF

# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ .env
cat > .env << 'ENVEOF'
TELEGRAM_BOT_TOKEN=8162966420:AAGsXVW0pjy2yxoC4J5uNJaBEL7ZFY_WgSE
OPENAI_API_KEY=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
GOOGLE_APPLICATION_CREDENTIALS=/app/google_credentials.json
DATABASE_URL=sqlite:////app/data/smartfinances.db
LOG_LEVEL=INFO
ENVEOF

# Ð˜ÑÐ¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð° Ð¸ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ð°Ð¿ÐºÑƒ Ð´Ð»Ñ Ð‘Ð”
chmod 600 google_credentials.json
chmod 644 .env
mkdir -p data

# Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Docker
docker-compose up -d --build

# ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚
sleep 5
echo ""
echo "âœ… Ð‘ÐžÐ¢ Ð—ÐÐŸÐ£Ð©Ð•Ð!"
docker-compose ps
echo ""
echo "ðŸ“Š Ð›Ð¾Ð³Ð¸:"
docker-compose logs --tail=20

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ÐžÐ‘ÐÐžÐ’Ð›Ð•ÐÐ˜Ð• (Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ Ñ€Ð°Ð·Ð°):

cd /var/www/smartfinances && git pull origin main && docker-compose up -d --build && sleep 3 && docker-compose logs --tail=20

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ÐŸÐžÐ›Ð•Ð—ÐÐ«Ð• ÐšÐžÐœÐÐÐ”Ð«:

# Ð›Ð¾Ð³Ð¸ Ð±Ð¾Ñ‚Ð° (Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸)
cd /var/www/smartfinances && docker-compose logs -f

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº
cd /var/www/smartfinances && docker-compose restart

# ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°
cd /var/www/smartfinances && docker-compose down

# Ð¡Ñ‚Ð°Ñ‚ÑƒÑ
cd /var/www/smartfinances && docker-compose ps

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Ð¡ Docker Ð±Ð¾Ð»ÑŒÑˆÐµ ÐÐ•Ð¢ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ñ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð°Ð¼Ð¸ Ð¸ Ð¿Ñ€Ð°Ð²Ð°Ð¼Ð¸!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
